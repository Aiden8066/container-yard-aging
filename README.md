# Container Yard Aging Visualization System

컨테이너 야드의 에이징(Aging) 데이터를 시각화하고 분석하는 PyQt5 기반 데스크톱 애플리케이션입니다.

## 📋 프로젝트 개요

이 시스템은 컨테이너 야드에서 발생하는 다양한 데이터를 수집, 분석하고 시각화하여 효율적인 야드 관리를 지원합니다. 여러 선사(Shipping Line)별 데이터를 관리하며, KPI 계산, 스토리지 비용 분석, 월별 데이터 추이 등의 기능을 제공합니다.

## 🚀 주요 기능

### 📊 데이터 시각화
- **다중 탭 인터페이스**: WM, AC, AV_AO, REF, MWO, DW, MN, TV, RB, JEM, FCL 등 11개 선사별 데이터 관리
- **실시간 차트**: 도넛 차트, 막대 그래프, 라인 차트를 통한 데이터 시각화
- **컨테이너 상태 차트**: 컨테이너 수량 및 상태별 분류 시각화

### 📈 KPI 관리
- **KPI 계산기**: 컨테이너 수에 따른 가산점 자동 계산
- **월별 데이터 분석**: 월별 스토리지 비용 및 컨테이너 수 추이 분석
- **DD 고객 분석**: 특별 고객군에 대한 별도 분석 기능

### 💰 비용 분석
- **스토리지 비용 계산**: 개별 컨테이너별 스토리지 비용 자동 계산
- **월별 비용 분석**: 시간대별 비용 변화 추이 분석
- **비용 최적화**: 데이터 기반 비용 절감 방안 제시

### 🔍 데이터 관리
- **SQLite 데이터베이스**: 안정적인 로컬 데이터 저장
- **데이터 필터링**: 날짜, 선사, 상태별 데이터 필터링
- **Excel 연동**: 데이터 가져오기/내보내기 기능

## 🛠️ 기술 스택

- **언어**: Python 3.x
- **GUI 프레임워크**: PyQt5
- **데이터 처리**: 
  - pandas (데이터 분석)
  - numpy (수치 계산)
- **시각화**: matplotlib
- **데이터베이스**: SQLite3
- **스타일링**: qdarkstyle (다크 테마)
- **기타**: win32com (Excel 연동)

## 📦 설치 및 실행

### 필수 요구사항
```bash
Python 3.7+
```

### 의존성 설치
```bash
pip install PyQt5
pip install pandas
pip install numpy
pip install matplotlib
pip install qdarkstyle
pip install pywin32
```

### 실행 방법
```bash
python CNTR_CY.py
```

## 📁 파일 구조

```
Container yard aging/
├── CNTR_CY.py              # 메인 애플리케이션 파일
├── master_database.db      # 메인 데이터베이스
├── Vessel contact.db       # 선사 연락처 데이터베이스
├── README.md              # 프로젝트 문서
└── .gitignore            # Git 무시 파일
```

## 🗄️ 데이터베이스 구조

### master_database.db
- 11개 테이블 (table1~table11): 각 선사별 컨테이너 데이터
- 컨테이너 정보, 입고일, 상태, 비용 등의 정보 저장

### Vessel contact.db
- 선사별 연락처 정보 관리
- 긴급상황 시 연락처 조회 기능

## 🎯 사용법

1. **프로그램 시작**: `python CNTR_CY.py` 실행
2. **데이터 선택**: 상단 탭에서 원하는 선사 선택
3. **데이터 시각화**: 자동으로 생성되는 차트 확인
4. **KPI 분석**: 메뉴에서 KPI 계산기 실행
5. **비용 분석**: 스토리지 비용 분석 기능 활용

## 📊 주요 화면

- **메인 대시보드**: 전체 데이터 개요 및 주요 지표
- **선사별 탭**: 각 선사의 상세 데이터 및 차트
- **KPI 창**: 성과 지표 계산 및 분석
- **월별 데이터 창**: 시간대별 추이 분석
- **비용 분석 창**: 스토리지 비용 상세 분석

## 🔧 설정

- **데이터베이스 경로**: 코드 상단의 `db_file` 및 `contact_db_path` 변수에서 설정
- **네트워크 경로**: 현재 `\\10.193.232.18\Java\우현 테스트\` 경로로 설정됨


## 📄 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다.

## 📞 문의사항

프로젝트에 대한 문의사항이나 버그 리포트는 GitHub Issues를 통해 제출해 주세요.

## 🔄 업데이트 내역

- **v1.0.0**: 초기 버전 릴리스
  - 기본 시각화 기능
  - KPI 계산기
  - 11개 선사 데이터 지원
  - 스토리지 비용 분석

---

**Container Yard Aging Visualization System** - 효율적인 컨테이너 야드 관리를 위한 통합 솔루션
